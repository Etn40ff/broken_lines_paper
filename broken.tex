\documentclass[11pt]{amsart}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{tikz}
\usepackage{hyperref}
\hypersetup{colorlinks=true,citecolor=blue,linkcolor=blue}

%\usepackage[margin=1in]{geometry}

% add yourself here in order to make comments on the side
\usepackage[draft]{say}
\newcommand{\sayDR}[1]{\say[DR]{#1}}
\newcommand{\saySS}[1]{\say[SS]{#1}}
\newcommand{\sayMC}[1]{\say[MC]{#1}}
\newcommand{\sayMG}[1]{\say[MG]{#1}}

% ambients
\newtheorem{lemma}{Lemma}[section]
\newtheorem{theorem}{Theorem}[section]
\newtheorem{propo}[theorem]{Proposition}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{cor}[theorem]{Corollary}
\newtheorem{conj}[theorem]{Conjecture}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{claim*}{Claim}
\newtheorem{rmk}[theorem]{Remark}
\newtheorem{thm}[theorem]{Theorem}
\newtheorem{defn}[theorem]{Definition}
\theoremstyle{remark}
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{question}[theorem]{Question}
\numberwithin{equation}{section}

% shorthands
\newcommand{\NN}{\mathbb{N}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\ZZ}{\mathbb{Z}}

\newcommand{\cA}{\mathcal{A}}

\newcommand{\fd}{\mathfrak{d}}
\newcommand{\fD}{\mathfrak{D}}
\newcommand{\fm}{\mathfrak{m}}

\newcommand{\gr}{\mathrm{gr}}

\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\Mono}{\operatorname{Mono}}
\newcommand{\Spec}{\operatorname{Spec}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\title{The greedy basis is the theta basis}
\author{CCGMMRSW}

\begin{document}
\maketitle

\section{Rank 2 cluster algebras and their greedy bases}
\saySS{This section was written by Dylan independently while Mark, Mandy and
  myself were working on sections 2 and 3. We should check that notations and
  conventions are consistent. I am ready to bet that we need to take a transpose somewhere.}\sayDR{Done, the conventions for mutations match.}
Fix $b,c>0$ and consider rational functions $x_m\in\QQ(x_1,x_2)$, for $m\in\ZZ$,
defined recursively by 
\[
  x_{m-1}x_{m+1}=
  \begin{cases}
    x_m^b+1 & \text{if $m$ is odd;}\\
    x_m^c+1 & \text{if $m$ is even.}
  \end{cases}
\] 
These functions are called \emph{cluster variables} and the \emph{cluster
algebra} $\cA(b,c)$ is the $\ZZ$-subalgebra of $\QQ(x_1,x_2)$ which they
generate.  While the cluster variables appear to be rational functions, it is a
remarkable fact that cancellations inevitably occur and one always obtains
Laurent expressions.  This result is known as the ``Laurent Phenomenon" and was
proven by Fomin and Zelevinsky.
\begin{theorem}\label{th:Laurent}\cite[Theorem~3.1]{FZ} 
  For any $k,m\in\ZZ$ we have $x_m\in\ZZ[x_k^{\pm1},x_{k+1}^{\pm1}]$.
\end{theorem}
\sayDR{In fact, they made the stronger conjecture that all of these Laurent
  expressions have positive coefficients.}

An element $x\in\ZZ[x_1^{\pm1},x_2^{\pm1}]$ is called \emph{pointed at
$(a_1,a_2)\in\ZZ^2$} if it can be written in the form
\[
  x=x_1^{-a_1}x_2^{-a_2}\sum\limits_{p,q\ge0}c(p,q)x_1^{bp}x_2^{cq},
\]
where $c(p,q)\in\ZZ$ with $c(0,0)=1$.  We will call such an $x$ \emph{positive
in the first cluster} if $c(p,q)\ge0$ for all $p,q\ge0$.  An element $x\in\cA(b,c)$ is simply called \emph{positive} if its Laurent expansion in each $\ZZ[x_k^{\pm1},x_{k+1}^{\pm1}]$ has positive coefficients.
\begin{prop}\cite[Proposition~1.5]{LLZ}
  Let $x$ be pointed at $(a_1,a_2)\in\ZZ^2$ and suppose
  $x\in\ZZ_{\ge0}[x_0^{\pm1},x_1^{\pm1}]
  \cap\ZZ_{\ge0}[x_1^{\pm1},x_2^{\pm1}]
  \cap\ZZ_{\ge0}[x_2^{\pm1},x_3^{\pm1}]$.
  Then the pointed coefficients $c(p,q)$ satisfy the following recursive
  inequality:
  \begin{align}
    \label{eq:consecutive positivity inequality}
    c(p,q)\ge\max\bigg(
    &\sum\limits_{k=1}^p (-1)^{k-1}c(p-k,q){a_2-cq+k-1\choose k}\\
    \nonumber&\sum\limits_{\ell=1}^q (-1)^{\ell-1}c(p,q-\ell){a_1-bp+\ell-1\choose \ell}\bigg).
  \end{align}
\end{prop}
A positive element $x\in\cA(b,c)$ is called \emph{indecomposable} if it cannot
be written as a sum of two positive elements.  In the search for positive bases
of $\cA(b,c)$ one is naturally led to investigate the indecomposable positive
elements.  A sufficient condition for a positive pointed element $x$ to be
indecomposable is the inequality \eqref{eq:consecutive positivity inequality}
being an equality.  It turns out that this requirement alone uniquely determines
a collection of elements of $\cA(b,c)$ with nice properties.

\begin{theorem}\label{th:greedy}\cite[Theorem~1.7]{LLZ}
  For any $(a_1,a_2)\in\ZZ^2$ there exists a unique indecomposable positive
  element $x[a_1,a_2]\in\cA(b,c)$ which is pointed at $(a_1,a_2)$ and whose
  pointed coefficients satisfy the recursion
  \begin{align}
    \label{eq:greey recursion}
    c(p,q)=\max\bigg(
    &\sum\limits_{k=1}^p (-1)^{k-1}c(p-k,q){a_2-cq+k-1\choose k}\\
    \nonumber&\sum\limits_{\ell=1}^q (-1)^{\ell-1}c(p,q-\ell){a_1-bp+\ell-1\choose \ell}\bigg).
  \end{align}
  Moreover, the collection $\{x[a_1,a_2]:(a_1,a_2)\in\ZZ^2\}$ is a basis of
  $\cA(b,c)$ which contains the cluster monomials and is independent of the
  choice of an initial cluster.
\end{theorem}
We will call $x[a_1,a_2]$ the \emph{greedy element} pointed at $(a_1,a_2)$ and
call $\{x[a_1,a_2]:(a_1,a_2)\in\ZZ^2\}$ the \emph{greedy basis} of $\cA(b,c)$.  Let
$R_{a_1,a_2}=\{(p,q)\in\ZZ_{\ge0}^2:c(p,q)\ne0 \text{ in } x[a_1,a_2]\}$ denote
the \emph{pointed support} of $x[a_1,a_2]$.  Theorem~\ref{th:greedy} is proven using the following characterization of the greedy elements by their
pointed supports.

\begin{theorem}\label{th:pointed supports}(\cite[Proposition~4.1]{LLZ} and \cite[Corollary 3.5]{LLZ2})
  For $(a_1,a_2)\in\ZZ^2$, the pointed support of
  \sayDR{Rewrite this in terms of the Newton polytope}\sayDR{But the pictures of the pointed support look better.}
  $x[a_1,a_2]$ is determined as follows.
\begin{enumerate}
  \item If $a_1 \leq 0$ and $a_2 \leq 0$, then $R_{a_1,a_2} = \{(0,0)\}$.
  \item If $a_1 \leq 0 < a_2$, then $R_{a_1,a_2} = \{(p,0): 0 \leq p \leq a_2\}$.
  \item If $a_2 \leq 0 < a_1$, then $R_{a_1,a_2} = \{(0,q): 0 \leq q \leq a_1\}$.
  \item If $0<ba_2\leq a_1$, then $R_{a_1,a_2}=\left\{(p,q)\in\ZZ_{\ge0}^2\big|\; p\le a_{2},\; q\le a_{1}-bp\right\}$.
  \item If $0<ca_1\leq a_2$, then $R_{a_1,a_2}=\left\{(p,q)\in\ZZ_{\ge0}^2\big|\; q\le a_{1},\; p\le a_{2}-cq\right\}$.
  \item If $0 < a_1 < ba_2$ and $0 < a_2 < ca_1$, then
  $$\aligned
  R_{a_1,a_2}=&\bigg\{(p,q)\in\ZZ_{\ge0}^2\bigg|\; 0\le p< \frac{a_1}{b},\; q+\Big(b-\frac{ba_2}{ca_1}\Big)p<a_1\bigg\}\\
  &\bigcup\bigg\{(p,q)\in\ZZ_{\ge0}^2\bigg|\; 0\le q<
    \frac{a_2}{c},\; p+\Big(c-\frac{ca_1}{ba_2}\Big)q<a_2\bigg\}\\
  &\hspace{1.35em}\bigcup\Big\{(0,a_1),(a_2,0)\Big\}.
  \endaligned
  $$
\end{enumerate}
Moreover, if $x\in\cA(b,c)$ is any positive element pointed at $(a_1,a_2)$ whose pointed support is equal to $R_{a_1,a_2}$, then $x=x[a_1,a_2]$. 
\end{theorem}
\begin{proof}
 The first part is the content of \cite[Proposition~4.1]{LLZ} and \cite[Corollary 3.5]{LLZ2}.  Suppose $x\in\cA(b,c)$ is a positive element pointed at $(a_1,a_2)$ and the pointed support of $x$ is equal to $R_{a_1,a_2}$.  If $x$ is indecomposable, then we must have $x=x[a_1,a_2]$.  So suppose 
\end{proof}

\begin{remark}
  Consider the points 
  \[
    O=(0,0), \quad A=(a_2,0), \quad B=(a_1/b, a_2/c), \quad C=(0,a_1),
  \]
  \[
    D_{1}=(a_{2},a_{1}-ba_{2}), \quad D_{2}=(a_{2}-ca_{1},a_{1}).
  \]  
  Then the pointed support of $x[a_1,a_2]$ can be visualized as follows:
  \begin{center}
    \begin{tikzpicture}[scale=.7]
      %(1)
      \begin{scope}[shift={(-2.75, 5.5)}]
        \usetikzlibrary{patterns}
        \draw (0,0) node[anchor=east] {\tiny $O$};
        \draw[->] (0,0) -- (3,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \draw (-1,-.5) circle (2pt);
        \draw (-1,-.5) node[anchor=south] {\tiny $B$};
        \draw (1.07,-.6) node[anchor=north] {\footnotesize (1) $a_1,a_2\le0$};
      \end{scope}
      %(2)
      \begin{scope}[shift={(2.75, 5.5)}]
        \usetikzlibrary{patterns}
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (2,0) node[anchor=south] {\tiny$A$};
        \draw[->] (0,0) -- (3,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (2,0) circle (2pt);
         \draw [thick] (0,0) -- (2,0);
        \draw (-1,.5) circle (2pt);
        \draw (-1,.5) node[anchor=south] {\tiny $B$};
        \draw (1.27,-.6) node[anchor=north] {\footnotesize (2) $a_1\le 0<a_2$};
      \end{scope}
      %(3)
      \begin{scope}[shift={(8.25,5.5)}]
        \usetikzlibrary{patterns}
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (0,2) node[anchor=east] {\tiny$C$};
        \draw[->] (0,0) -- (3,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (0,2) circle (2pt);
        \draw [thick] (0,0) -- (0,2);
        \draw (1,-.3) circle (2pt);
        \draw (1,-.3) node[anchor=west] {\tiny $B$};
        \draw (1.27,-.6) node[anchor=north] {\footnotesize (3) $a_2\le0<a_1$};
      \end{scope}
      %(4)
      \begin{scope}[shift={(0,0)}]
        \usetikzlibrary{patterns}
        %\fill[pattern=horizontal lines] (-2.5,2)--(-1,.5)--(-1,-1)--(-2.5,-1)--(-2.5,2);
        \fill[black!10] (0,3)--(1.5,1.5)--(1.5,0)--(0,0)--(0,3);
        \draw[thick] (0,3)--(1.5,1.5)--(1.5,0)--(0,0)--(0,3);
        \draw[dashed,thick](0,3)--(2.15,1.25) (2.15,1.15)--(1.5,0);
        \draw (2.2,1.2) circle (2pt);
        \draw (2.3,1.2) node[anchor=west] {\tiny$B$};
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (1.5,-.1) node[anchor=south west] {\tiny$A$};
        \draw (1.4,1.5) node[anchor= south west] {\tiny$D_{1}$};
        \draw (0,3) node[anchor=east] {\tiny$C$};
        \draw[->] (0,0) -- (3.5,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3.5) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (0,3) circle (2pt);
        \fill (1.5,0) circle (2pt);
        \fill (1.5,1.5) circle (2pt);
        \draw (1.37,-.5) node[anchor=north] {\footnotesize (4) $0<ba_2\leq a_1$};
      \end{scope}
      %(5)
      \begin{scope}[shift={(5.5,0)}]
        \usetikzlibrary{patterns}
        \fill[black!10] (3,0)--(1.3,1)--(0,1)--(0,0)--(3,0);
        \draw[thick] (3,0)--(1.3,1)--(0,1)--(0,0)--(3,0);
        \draw[dashed,thick](3,0)--(0.95,1.45) (0.85,1.47)--(0,1);
        \draw (0.9,1.5) circle (2pt);
        \draw (0.9,1.5) node[anchor=south] {\tiny$B$};
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (2.7,0) node[anchor=south west] {\tiny$A$};
        \draw (1.3,.9) node[anchor=south west] {\tiny$D_{2}$};
        \draw (0,1) node[anchor=east] {\tiny$C$};
        \draw[->] (0,0) -- (3.5,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3.5) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (0,1) circle (2pt);
        \fill (3,0) circle (2pt);
        \fill (1.3,1) circle (2pt);
        \draw (1.37,-.5) node[anchor=north] {\footnotesize (5) $0<ca_1\leq a_2$};
      \end{scope}
      %(6)
      \begin{scope}[shift={(0,-5.5)}]
        \usetikzlibrary{patterns}
        \fill[black!10]  (0,3)--(1.5,2.3)--(2,0)--(0,0)--(0,3);
        \draw[dashed,thick] (0,3)--(1.5,2.3)--(2,0);
        \draw[thick] (0,3)--(0,0)--(2,0); 
        \fill[white] (1.5,2.3) circle (2pt);
        \draw (1.5,2.3) circle (2pt);
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (1.8,0) node[anchor=south west] {\tiny$A$};
        \draw (1.5,2.3) node[anchor=south west] {\tiny$B$};
        \draw (0,3) node[anchor=east] {\tiny$C$};
        \draw[->] (0,0) -- (3.5,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3.5) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (0,3) circle (2pt);
        \fill (2,0) circle (2pt);
        \draw (1.42,-.5) node[anchor=north] {\footnotesize (6) $0<a_1<ba_2$,};
        \draw (1.46,-1) node[anchor=north] {\footnotesize \hspace{10pt} $0<a_2<ca_1$,};
        \draw (1.17,-1.5) node[anchor=north] {\footnotesize \hspace{10pt} \tiny{$(a_1,a_2):$ non-imaginary root}};
      \end{scope}
      %(6')
      \begin{scope}[shift={(5.5,-5.5)}]
        \usetikzlibrary{patterns}
        \fill[black!10]  (0,3)--(.7,.5)--(2,0)--(0,0)--(0,3);
        \draw[dashed,thick] (0,3)--(.7,.5)--(2,0);
        \draw[thick] (0,3)--(0,0)--(2,0);
        \draw (0,0) node[anchor=east] {\tiny$O$};
        \draw (1.8,0) node[anchor=south west] {\tiny$A$};
        \fill[white] (.7,.5) circle (2pt);
        \draw (.7,.5) circle (2pt);
        \draw (.7,.5) node[anchor=south west] {\tiny$B$};
        \draw (0,3) node[anchor=east] {\tiny$C$};
        \draw[->] (0,0) -- (3.5,0) node[above] {\tiny $p$};
        \draw[->] (0,0) -- (0,3.5) node[left] {\tiny $q$};
        \fill (0,0) circle (2pt);
        \fill (0,3) circle (2pt);
        \fill (2,0) circle (2pt);
        \draw (1.47,-.5) node[anchor=north] {\footnotesize (6) $0<a_1<ba_2$,};
        \draw (1.51,-1) node[anchor=north] {\footnotesize \hspace{10pt} $0<a_2<ca_1$,};
        \draw (1.27,-1.5) node[anchor=north] {\footnotesize \hspace{10pt} \tiny{$(a_1,a_2):$ imaginary root}};
      \end{scope}
    \end{tikzpicture}
    \quad\quad\quad\quad
  \end{center}
\end{remark}

To prove Theorem~\ref{th:pointed supports} Lee, Li, and Zelevinsky develop a
combinatorial construction via compatible pairs on a maximal Dyck path.  

For $(a_1,a_2)\in\ZZ_{\ge0}^2$, a Dyck path in the rectangle
$[0,a_1]\times[0,a_2]$ is a lattice path beginning at $(0,0)$ which takes steps
to the east and north to end at $(a_1,a_2)$ while never crossing above the main
diagonal.  Let $D_{a_1,a_2}$ denote the maximal such Dyck path, i.e. any lattice
point lying strictly above the Dyck path $D_{a_1,a_2}$ also lies above the main
diagonal.  

Let $H$ and $V$ denote the sets of horizontal and vertical edges of
$D_{a_1,a_2}$.  For edges $e_1,e_2\in D_{a_1,a_2}$ write $e_1e_2$ for the
subpath of $D_{a_1,a_2}$ which begins at $e_1$ and terminates at $e_2$.  When
$e_1$ comes after $e_2$ the path $e_1e_2$ begins at $e_1$ goes to the end of
$D_{a_1,a_2}$ and then continues from the beginning of $D_{a_1,a_2}$ to $e_2$.
Write $(e_1e_2)_H$ and $(e_1e_2)_V$ for the sets of horizontal and vertical
edges in $e_1e_2$.

For $S_1\subset H$ and $S_2\subset V$ we call the pair $(S_1,S_2)$
\emph{compatible} if for each $h\in S_1$ and $v\in S_2$ there exists an edge
$e\in hv$ such that one of the following holds:
\begin{align*}
 \tag{HSC}\label{eq:horizontal shadow condition}\big|(he)_V\big|=b\big|(he)_H\cap S_1\big|\quad&\text{and}\quad e\ne v;\\
 \tag{VSC}\label{eq:vertical shadow condition}\big|(ev)_H\big|=c\big|(ev)_V\cap S_2\big|\quad&\text{and}\quad e\ne h.\\
\end{align*}
We call the first the ``horizontal shadow condition" and call the second the
``vertical shadow condition".
\begin{theorem}
  \label{th:combinatorial greedy}\cite[Theorem~1.11]{LLZ}
  For any $(a_1,a_2)\in\ZZ^2$ we have
  \begin{equation}
    \label{eq:combinatorial greedy}
    x[a_1,a_2]=x_1^{-a_1}x_2^{-a_2}\sum\limits_{(S_1,S_2)}x_1^{b|S_2|}x_2^{c|S_1|},
  \end{equation}
  where $(S_1,S_2)$ runs over all compatible pairs in the maximal Dyck path
  $D_{[a_1]_+,[a_2]_+}$.
\end{theorem}

\section{Scattering diagrams and broken lines}
\saySS{We are using Fock-Goncharov conventions through the paper; in particular
  we denote initial cluster variables by $A_i$ and we read mutations by rows.
  All the relevant notions, (in particular $d$- and $g$-vectors) are
  the ``transposed'' of those in Fomin-Zelevinsky and Lee-Li-Zelevinsky. We
  should mention these facts in the introduction.}
In this section, we will describe the cluster algebras $\cA (b,c)$ from the
point of view of scattering diagrams. While all the results in this section are
derived from \cite{GHKK}, we will adopt a slightly simplified notation here
sufficient for the rank $2$ case.

Let $N = \ZZ^2$ be a lattice and $M = \Hom (N, \ZZ)$. We will write elements of
$N$ and of $M$ both as tuples and, for $m\in N$, $n\in N$, we will denote their 
standard pairing by $n \cdot m$. Write
$M_{\RR} = M\otimes\RR$, $N_{\RR} = N\otimes\RR$. Take $\Bbbk$ to be a field of
characteristic 0.  For $m\in M$ we will write $A^m$ for the monomial in
$\Bbbk[M]$.  For notational convenience we will write $A_1=A^{(1,0)}$ and
$A_2=A^{(0,1)}$, thus we may identify $A^m$ with $A_1^{m_1}A_2^{m_2}$.

Let $\sigma \subsetneq M_{\RR}$ be a strictly convex rational cone; set
$P=\sigma \cap M$, and write $\widehat{\Bbbk[P]}$ for the completion of the
monoid ring $\Bbbk[P]$ at the maximal monomial ideal $\fm$ generated by
$\left\{A^m \,|\, m\in P\setminus\{0\}\right\}$.

\begin{defn}
  \label{walldef}
  A \emph{wall} is a pair $(\fd, f_{\fd})$, where 
  \begin{itemize}

    \item 
      $\fd \subset M_{\mathbb{R}}$ is either a ray $\RR_{\le 0} w$ or a line
      $\RR w$ with $w\in \sigma \cap(M\setminus 0)$;

    \item 
      $f_{\fd} \in \widehat{\Bbbk [P]}$ is such that 
      \[ 
        f_{\fd} = f_{\fd}(A^w) = 1 + \sum_{k\geq 1} c_k A^{k w},
      \] 
      for some $c_k \in \Bbbk$. 
  \end{itemize}
  The set $\fd \subset M_{\mathbb{R}}$ is called the \emph{support} of the wall
  $(\fd, f_{\fd})$.
\end{defn}

\begin{defn}
  \label{def:scattering_diagram}
  A scattering diagram $\fD$ is a collection of walls such that, for each $k \geq
  0$, the set
  \[
    \{ (\fd, f_{\fd}) \in \fD\, |\, f_{\fd} \neq 1 \bmod \fm^k \}
  \]
  is finite. For semplicity we diverge slightly form the convention in
  \cite{GHKK} by requiring that $\fd_1 \neq \fd_2$ whenever $f_{\fd_1}\neq
  f_{\fd_2}$.
\end{defn}

For a scattering diagram $\fD$, we denote the support of $\fD$ as
\[
  \text{Supp} (\fD) := \bigcup_{(\fd, f_{\fd}) \in \fD} \fd. 
\]

To each wall $(\fd, f_{\fd})$, given a direction $v$ transversal to $\fd$, one
can associate the element $\theta_{v,\fd}\in
{\mathrm{Aut}}_{\Bbbk-alg}\left(\widehat{\Bbbk[P]}\right)$ defined by
\[
  \theta_{v,\fd} (A^m) := A^m f_{\fd}^{m\cdot n }, 
\]
where $n\in N$ is primitive, annihilates the tangent space to $\fd$, and is
uniquely determined by the sign convention $ v\cdot n <0$.  Note
that the only role of the transversal direction $v$ is to fix which of the two
normals $\pm n$ is used in the exponent. 

Consider a smooth immersion
\[  
  \gamma: [0,1] \rightarrow M_{\mathbb{R}} \backslash  \{0 \}  
\]
with endpoints not in the support of $\fD$. Assume $\gamma$ is transversal to
each wall of $\fD$ that it crosses. For each power $k \geq 1$, let  
\[
  0< t_1 <  t_2 < \cdots < t_s < 1 
\]
be the longest sequence of numbers such that $\gamma(t_i)\in\fd_i$ for some wall
$(\fd_i,f_{\fd_i}) \in \fD$ with $f_{\fd_i} \neq 1 \text{ mod } \fm^k$.

In view of the definition of scattering diagram, such a sequence is finite; we
can therefore consider the composition 
\[
  \theta^k_{\gamma, \fD} :=
  \theta_{\gamma'(t_s),\fd_s} \circ \cdots \circ \theta_{\gamma'(t_1),\fd_1}.
\]
Define the \textit{path-ordered product} along $\gamma$ as
\[
  \theta_{\gamma, \fD} := \lim_{k \rightarrow \infty} \theta ^k_{\gamma, \fD}. 
\]

\begin{defn}
  A scattering diagram is \emph{consistent} if $\theta _{\gamma, \fD}$ depends
  only on the endpoints of $\gamma$ for any path $\gamma$ for which
  $\theta_{\gamma, \fD}$ is well defined.
\end{defn}

\begin{theorem}[Kontsevich-Soibelman] 
  \label{KS}
  Given a scattering diagram $\fD$, there always exists a consistent scattering
  diagram $\fD'$ which contains $\fD$ such that $\fD'\setminus\fD$ only consists
  of rays.
\end{theorem}

We will now describe the scattering diagram $\fD_{(b,c)}$ associated to 
$\cA(b,c)$.
Recall that the initial exchange matrix in $\cA(b,c)$ is 
\[
  \epsilon = \begin{pmatrix} 0 & c\\ -b & 0\end{pmatrix},
\]
where $b$, $c$ are positive integers.  Following Example 1.30 of \cite{GHKK}, we
take $\sigma$ to be the second quadrant, i.e., the cone generated by $(-1,0)$ and
$(0,1)$. Then the ``initial'' scattering diagram associated to the above exchange
matrix is
\[
  \fD_{\mathrm{in},(b,c)} := 
  \left\{
    \big( \RR (-1,0), 1+A_1^{-b}\big), 
    \big( \RR (0,1), 1+A_2^c\big) 
  \right\}.
\]

We will denote by $\fD_{(b,c)}$ the consistent scattering diagram obtained by
applying Theorem \ref{KS} to $\fD_{\mathrm{in},(b,c)}$.

\begin{example} 
  \label{ex}
  Consider $\cA(2,1)$. Then we get
  \[
    \fD_{\mathrm{in},(2,1)} =  
    \left\{ 
      \big(\RR (-1,0), 1+A_1^{-2}\big), 
      \big(\RR (0,1), 1+A_2\big)  
    \right\}   
  \]
  and the associated consistent scattering diagram $\fD_{(2,1)}$ (shown in
  Figure~\ref{fig:diagex}) contains $\fD_{\mathrm{in},(2,1)}$ together with
  the two walls
  \[ 
    \big( \RR_{\leq 0} (-1,1), 1+A_1^{-2}A_2^2 \big)
    \quad \mbox{and} \quad
    \big( \RR_{\leq 0} (-2,1), 1+A_1^{-2}A_2 \big).
  \]
\end{example}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \draw (3,0) -- (-3,0) node[left] {$1+A_1^{-2}$};
    \draw (0,-3) -- (0,3) node[above] {$1+A_2$};
    \draw (0,0) -- (3,-3) node[below right] {$1+A_1^{-2}A_2^2$};
    \draw (0,0) -- (3,-1.5) node[below right] {$1+A_1^{-2}A_2$};
  \end{tikzpicture}
  \caption{The scattering diagram $\fD_{(2,1)}$} 
  \label{fig:diagex}
\end{figure}

For general $b$ and $c$, the diagram $\fD_{(b,c)} \backslash
\fD_{\mathrm{in},(b,c)}$ may consist of an infinite number of rays, and in fact
it is infinite precisely when $bc\ge 4$. A more detailed description of the rays
which appear can be found in \cite{GHKK}, Example 1.30. We summarize the crucial
points here.

First of all note that, in view of the definition of scattering diagram, all the
rays in  $\fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$ are contained in the
fourth quadrant.  To make our next observation we need to extend the action of
linear operators on $M_\RR$ to an action on pairs $(\fd,f_\fd)$. If $S$ is
linear on $M_\RR$ set
\begin{equation}
  \label{eqn:linear action}
  S(\fd,f_\fd(A^w))
  :=
  \left( S(\fd), f_\fd\left(A^{S(w)}\right) \right)
\end{equation}
Note that, even if $(\fd,f_\fd)$ is a wall, $S(\fd,f_\fd)$ needs not be a wall
since $S(w)$ may lay outside of the cone $\sigma$ (in which case we also get
that  $f_\fd\left(A^{S(w)}\right)$ is not an element of $\widehat{\Bbbk [P]}$).

Now consider the two linear involutions $S_1$ and $S_2$ given by
\[
  S_1 =  
  \begin{pmatrix}
    -1 & -b \\
    0& 1
  \end{pmatrix}
  %
  \quad
  \mbox{and}
  \quad
  %
  S_2 =  
  \begin{pmatrix}
    1 & 0 \\
    -c & -1
  \end{pmatrix}.
\]
If $(\fd, f_{\fd}) \in \fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$ and $S_i
(\fd)$ is contained strictly in the fourth quadrant, then $S_i(\fd, f_{\fd}) \in
\fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$. Moreover both 
\begin{equation}
  \label{eq:first-walls}
  S_2\big(\RR_{\leq 0}(-1,0),1+A_1^{-b}\big)
  %
  \quad
  \mbox{and}
  \quad
  %
  S_1\big(\RR_{\leq 0}(0,1),1+A_2^c\big)
\end{equation}
are walls in $\fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$ even though
neither 
\[
  \big(\RR_{\leq 0}(-1,0),1+A_1^{-b}\big)
  %
  \quad
  \mbox{nor}
  \quad
  %
  \big(\RR_{\leq 0}(0,1),1+A_2^c\big)
\]
are walls in $\fD_{(b,c)}$. These considerations gives us a recipe to produce
elements of $\fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$: it is enough to apply
alternatively $S_1$ and $S_2$ to the walls (\ref{eq:first-walls}).

We need to distinguish two cases. If $bc<4$ this procedure will construct, in
finitely many steps, all the walls in $\fD_{(b,c)} \backslash
\fD_{\mathrm{in},(b,c)}$.  If $bc\geq 4$, instead, we will get two infinite
families of walls whose supports will converge to the boundary of the convex cone
spanned by the irrational vectors
\[
  \left(2b,-bc + \sqrt{bc(bc-4)}\right)
  \quad
  \mbox{and}
  \quad
  \left(2b,-bc - \sqrt{bc(bc-4)}\right)
\]
These will exhaust all the walls in  $\fD_{(b,c)} \backslash \fD_{\mathrm{in},(b,c)}$
with support laying outside of this cone. The structure of the remaining part of 
$\fD_{(b,c)}$ is not completely understood; the expectation is that there is
a wall for each possible rational slope inside the irrational cone.
\sayMC{more detail at end?}
\sayMG{Wait and see what other facts we need about
  the diagram.} 

On the other hand the chamber structure one sees outside of the irrational cone
is very well-behaved and familiar in the theory of cluster algebras. This
chamber structure coincides with the Fock-Goncharov cluster complex, see
\cite{GHKK}, \S2, the mutation fan of Reading \cite{R}, and the picture group of
Igusa-Orr-Todorov-Weyman \cite{IOTW}.

\begin{figure}
  \input{scatter32_depth100}
  \caption{The supports of all the walls $(\fd,f_\fd)$ in $\fD_{(3,2)}$ such
    that $f_\fd \neq 1 \bmod \fm^{100}$; the boundary rays of
    the irrational cone are highlighted.} 
  \label{diagram32}
\end{figure}

The following result explains the connection between scattering diagrams
and the corresponding cluster algebras: 
\saySS{Wen we write the introductory part on cluster algebras we might want to
  mention what universal Laurent polynomials are}
\begin{theorem} 
  \label{univLaurent} 
  Let $\fD:=\fD_{(b,c)}$ as constructed above.  Let $f \in \Bbbk[M]$ be a
  Laurent polynomial. For any path $\gamma$ for which $\theta_{\gamma,\fD}$ is
  defined, $\theta_{\gamma,\fD}(f)$ can be viewed as an element of
  $\Bbbk[[A_1,A_2^{-1}]]$ localized at $A_1A_2^{-1}$. Then $f$ is a universal
  Laurent polynomial for the initial seed data if, for any path $\gamma$ in
  $M_{\RR}$ with starting point in the first quadrant and endpoint in one of the
  chambers of $\fD$, $\theta_{\gamma,\fD}(f)$ in fact lies $\Bbbk[M]$.
\end{theorem}

\begin{proof}
  This is essentially \cite{GHKK}, Theorem 4.4, applied to the case at hand.
  Specifically, let $\cA$ be the custer variety defined by the given choice of
  seed. By definition, $\cA$ is given by gluing together a collection of tori
  via cluster transformations, and a regular function on $\cA$ is precisely a
  universal Laurent polynomial, i.e., a Laurent polynomial which remains a
  Laurent polynomial after any sequence of mutations. On the other hand, in
  \cite{GHKK}, \S 4, another variety $\cA'$ is defined. This is done by
  associating a torus $\cA_{\tau}':= \Spec \Bbbk[M]$ to a chamber $\tau\subseteq
  M_{\RR}$ of $\fD$. For any two chambers $\tau,\tau'$ we can glue $\cA_{\tau}'$
  to $\cA_{\tau'}'$ using the rational map defined on function fields by
  $\theta_{\gamma,\fD}:\Bbbk(A_1,A_2)\rightarrow \Bbbk(A_1,A_2)$, where $\gamma$
  is a path beginning in $\tau'$ and ending in $\tau$. Performing these gluings
  gives $\cA'$.

  Now \cite{GHKK}, Theorem 4.4 gives an explicit isomorphism between $\cA$ and
  $\cA'$, and thus the algebra of regular functions on $\cA$ and $\cA'$ are
  isomorphic. Furthermore, this isomorphism restricts to the identity on the
  torus of $\cA$ corresponding to the initial seed and the torus of $\cA'$
  corresponding to the positive chamber. In particular, a function $f$ on this
  torus extends to a function on $\cA'$ if $\theta_{\gamma,\fD}(f)$ lies in
  $\Bbbk[M]$ for any path $\gamma$ from the positive chamber to any other
  chamber. This shows the characterization of universal Laurent polynomials.
\end{proof}

We will now define broken lines. Broken lines were introduced in \cite{G10} as a
way of describing, in a tropical manner,  holomorphic disks which appear in
mirror symmetry.  Their theory was further developed in \cite{CPS}, and then
used in \cite{GHK11} and \cite{GHKK} to construct canonical bases in various
circumstances.

\begin{defn} 
  \label{brokendef}
  Let $\fD$ be a scattering diagram, $m \in M \backslash \{0\}$ and $Q \in
  M_{\RR} \backslash \text{Supp}(\fD)$.  A \emph{broken line} with initial slope
  $m$ and endpoint $Q$ is a continuous and piecewise linear path $\gamma : ( -
  \infty , 0] \rightarrow M_{\mathbb{R}} \backslash \{ 0\} $ with a finite
  number of domains of linearity, along with a choice of monomials $c(L) A^{m(L)}
  \in \Bbbk[M]$ one for each domain of linearity $L \subseteq ( - \infty, 0]$ of
  $\gamma$. 
  
  The path $\gamma$ and the monomials $c(L) A^{m(L)}$ need to satisfy the
  following conditions:
  \begin{itemize}
    \item 
      $\gamma(0) = Q$.
    
    \item 
      If $L$ is the first (i.e., unbounded) domain of linearity of $\gamma$,
      then $c(L) A^{m(L)} = A^{m}$.

    \item 
      For $t$ in a domain of linearity $L$, $\gamma'(t) = -m(L)$.

    \item 
      $\gamma$ bends only when it crosses a wall. If $\gamma$ bends from the
      domain of linearity $L$ to $ L'$ when crossing $(\fd, f_{\fd})$, then
      $c(L')A^{m(L')}$ is a term in $\theta_{-m(L), \fd} \left(c(L)
        A^{m(L)}\right)$.  
  \end{itemize}
\end{defn}

We are finally ready to introduce the main player of our discussion.
For a broken line $\gamma$  denote by
$\Mono (\gamma)$ the monomial attached to the last domain of linearity of $\gamma$.
\begin{defn}
  Let $\fD, m, Q$ as in Definition~\ref{brokendef}.  Define the \emph{theta function} corresponding to $m$ and $Q$
  as
  \[ 
    \vartheta_{Q, m} = \sum_{\gamma} \Mono (\gamma), 
  \] 
  where the sum is over all broken lines with initial slope $m$ and endpoint
  $Q$.
\end{defn}

\begin{example} 
  \label{brokenex}
  Consider the scattering diagram $\fD_{(2,2)}$ and let $Q$ be a small
  irrational perturbation of the point $(1.5,1)$. There are three broken lines
  with initial slope $m = (1,-1)$ and endpoint $Q$ as shown in
  Figure~\ref{figbrokenex}.
  First of all, we can have a broken line $\gamma_1$ which does not bend.
  Therefore
  \[
    \Mono(\gamma_1) = A_1 A_2^{-1}.
  \]
  There is the broken line $\gamma_2$  which bends only at the $x$-axis. Since
  \[ 
    \theta_{(-1,1), \RR(-1,0)} (A_1 A_2^{-1}) = 
    A_1 A_2^{-1}(1+A_1^{-2}) =  A_1 A_2^{-1} + A_1^{-1} A_2^{-1},
  \]
  to bend we need to choose the second term and obtain 
  \[
    \Mono(\gamma_2) =  A_1^{-1} A_2^{-1}.
  \]
  The last broken line $\gamma_3$ bends both at the $x$- and $y$-axes, the
  latter bend coming from
  \[ 
    \theta_{ (1,1), \RR (0,1)} ( A_1^{-1} A_2^{-1}) =  
    A_1^{-1} A_2^{-1} + A_1^{-1} A_2.  
  \]
  This time we have 
  \[
    \Mono (\gamma_3) = A_1^{-1} A_2.
  \]
  Thus the theta function associated to $m = (1,-1)$ with endpoint point $Q$ is 
  \[ 
    \vartheta_{Q, (1,-1)} =  
    A_1 A_2^{-1} + A_1^{-1} A_2^{-1} +A_1^{-1} A_2 .  
  \]
\end{example}

\begin{figure}
  \centering
  \begin{tikzpicture}
    \draw (3,0) -- (-3,0) node[left] {$1+A_1^{-2}$};
    \draw (0,-3) -- (0,3) node[above] {$1+A_2^2$};
    \draw (0,0) -- (3,-1.5) node[right] {$1+A_1^{-4}A_2^2$};
    \draw (0,0) -- (1.5,-3) node[below] {$1+A_1^{-2}A_2^4$};
    \draw (1.5,1) node[circle, right] {$Q$};
    \draw[dotted] (1.4,-2.8) -- (2.8,-1.4);
    \draw[red] (3,-0.5) -- (1.5,1);
    \draw[red] (2.1,0.1) node[above right]{\small $A_1 A_2^{-1}$};
    \draw[red] (3,-0.5) node[left]{$\gamma_1$};
    \draw[blue] (0.5,0) -- node[left] {\small $A_1^{-1} A_2^{-1}$}  (1.5,1);
    \draw[blue] (0.5,0) -- node[below] {\small $A_1 A_2^{-1}$} (3,-2.5);
    \draw[blue] (3,-2.5) node[left]{$\gamma_2$};
    \draw[green] (0,2.5)  -- node[right] {\small $A_1^{-1}A_2$} (1.5,1);
    \draw[green] (-2.5,0) -- node[left] {\small $A_1^{-1} A_2^{-1}$}  (0,2.5);
    \draw[green] (0.5, -3)  --node[left] {\small $A_1 A_2^{-1}$} (-2.5,0);
    \draw[green] (0.5,-3) node[above]{$\gamma_3$};
  \end{tikzpicture}
  \caption{Example~\ref{brokenex}} 
  \label{figbrokenex}
\end{figure}

The following summarizes the main properties of the theta functions as shown in
\cite{GHKK}:
\begin{theorem} $ $
  \begin{enumerate}
    \item
      If $\fD$ is any consistent scattering diagram, $Q$, $Q'$ are two general
      irrational points on $M_{\RR} \backslash$ Supp$(\fD)$, and $\gamma$ is a
      path joining $Q$ to $Q'$, then 
      \[
        \theta_{\gamma, \fD }(\vartheta_{Q,m}) = \vartheta_{Q', m}. 
      \]
    
    \item 
      Taking $\fD=\fD_{(b,c)}$, if $Q$ lies in the interior of a chamber of
      $\fD$, then $\vartheta_{Q,m}$ is a Laurent polynomial for any $m$.
    
    \item 
      Taking $\fD=\fD_{(b,c)}$, if $Q$ lies in the interior of the first
      quadrant, then $\vartheta_{Q,m}$ is a universal Laurent polynomial for
      any $m$.

    \item 
      Taking $\fD=\fD_{(b,c)}$, if $m$ lies in the interior of a chamber of
      $\fD$, and $Q$ lies in the same chamber, then $\vartheta_{Q,m}=A^{m}$.
   
  \end{enumerate}
\end{theorem}

\begin{proof}
  (1) is a main result of \cite{CPS}, quoted in this context in \cite{GHKK},
  Theorem 3.5.  The second statement is \cite{GHKK}, Example 7.18: there,
  $\Theta$ is the subset of $M$ consisting of those $m$ for which
  $\vartheta_{Q,m}$ is a Laurent polynomial for $Q$ in the interior of 
  some chamber of $\fD$ (and hence by \cite{GHKK}, Proposition 7.1, all 
  chambers).
  Next, (3) follows from (2) by Theorem \ref{univLaurent}. 
  Finally, (4) follows from \cite{GHKK}, Proposition 3.8 (use the argument of
  \cite{GHKK}, Theorem 4.8 in the case that the chamber is not the positive
  quadrant.)
\end{proof}

\begin{remark} 
  \label{rk:theta functions g-vector}
  If $m\in M$ lies in one of the chambers of $\fD_{(b,c)}$, and $Q$ lies in
  the first quadrant, then from (1) and (4) of the above theorem,
  $\vartheta_{Q,m}=\theta_{\gamma,\fD_{(b,c)}}(A^{m})$ for a path $\gamma$
  joining the chamber containing $m$ to $Q$. Moreover it follows from the
  details of the proof of Theorem \ref{univLaurent} that $\vartheta_{Q,m}$ is
  a cluster monomial, and from \cite{GHKK}, Theorem 7.5, that the 
  ${\bf g}$-vector of this cluster monomial is precisely $m$. 
\end{remark}

\begin{example}
  Let us try one more calculation with broken lines. We take the same scattering
  diagram as in example~\ref{brokenex}. Now take the initial slope $m=(2,-2)$
  with the same endpoint $Q$. By similar calculations we get 
  \[ 
    \vartheta _{Q, (2,-2)} = 
    A_1^2 A_2^{-2} + A_1^{-2}A_2^2 + A_1^{-2}A_2^{-2} + 2 A_2^{-2} + 2A_1^{-2}.  
  \]
  Note that 
  \[ 
    \vartheta _{Q, (2,-2)} = 
    \left(\vartheta_{Q, (1,-1)}\right) ^2 -2. 
  \]
  In this scattering diagram $\fD_{(2,2)}$, the ray with slope $(1,-1)$ does
  not lie in the interior of any chamber. So neither $\vartheta_{Q,(1,-1)}$ nor 
  $\vartheta _{Q, (2,-2)}$ are cluster monomials.

  There are a number of known bases for $\cA(2,2)$, which give different results
  for the basis elements with ${\bf g}$-vectors $(d,-d)$ for $d>0$. Our
  calculations shows that at least for $d=1$ or $2$, theta functions agree with
  the greedy basis elements.
\end{example}


\section{Relation to greedy bases}
\saySS{At a certain point in our discussion in Snowbird we decided we were going
  to use the scattering diagram $\fD_{\mathrm{gr},(b,c)}$ instead of
  $-\fD_{\mathrm{gr},(b,c)}$ because we would have the base point $Q$ in the
  first quadrant and most of the rays in the third one. By doing so we get that
  theta functions in $\fD_{\mathrm{gr},(b,c)}$ are parametrized by the
  \emph{negative} of their ${\bf d}$-vectors. On the other hand, in
  $\fD_{(b,c)}$ theta functions are parametrized by their ${\bf g}$-vectors.
  This is slightly counterintuitive, maybe it is  more natural to change
  our convention.}
\sayMG{I would be slightly inclined to stick with the convention we
  are currently using in the paper, as it is a less drastic change
  from what is used in GHKK}
As mentioned in Remark \ref{rk:theta functions g-vector}, theta functions are
parametrized by their ${\bf g}$-vectors. On the other hand the description of
greedy elements given in \cite{LLZ} is in terms of their ${\bf d}$-vectors (cf.
Remark 1.9 ibid.). 

In order to compare the two we will leverage the observation that, in rank 2,
these families of vectors are related by an easy piecewise-linear transformation
as explained in the paragraph following Conjecture 3.21 in \cite{RS}. We will do
so via a scattering diagram $\fD_{\mathrm{gr},(b,c)}$ closely related to
$\fD_{(b,c)}$.

Let $T:M_\RR\rightarrow M_\RR$ be the piecewise-linear map given by
\[
  T (m) := 
  \begin{cases}
    m   & m_2 \geq 0 \\
    m + (bm_2,0), & m_2 \leq 0.
  \end{cases}
\]
We will denote its domains of linearity by 
\[ 
  \mathcal{H}_{+} := 
  \left\{ m \in M_{\mathbb{R}}\, |\, m_2 \geq 0 \right\} 
  \quad
  \mbox{and}
  \quad
  \mathcal{H}_{-} := 
  \left\{ m \in M_{\mathbb{R}} \,|\, m_2 \leq 0 \right\}.
\]
Let $T_+$ and $T_-$ be the linear extensions to $M_\RR$ of $T|_{\mathcal{H}_+}$
and $T|_{\mathcal{H}_-}$ respectively ($T_+$ is just the identity map but it
will be convenient to use this notation in what follows). 
By (\ref{eqn:linear action}) both $T_+$ and $T_-$ act on pairs $(\fd,f_\fd)$ so
we can use them to define the image of such pairs under $T$. Namely set
\[
  T(\fd,f_\fd):=
  \left\{
    T_+\left(\fd\cap\mathcal{H}_+,f_\fd\right),
    T_-\left(\fd\cap\mathcal{H}_-,f_\fd\right)
  \right\}.
\]

Having fixed the notation we are ready to introduce $\fD_{\mathrm{gr},(b,c)}$.
The set
\[
  T(\fD_{(b,c)}):=
  \left\{
    T(\fd,f_\fd)\, |\, (\fd,f_\fd)\in \fD_{(b,c)}
  \right\}
\]
is not a scattering diagram according to Definition 
\ref{def:scattering_diagram} (not all of its elements are walls for the same
convex cone) but can be made into one by few quick fixes.

First of all $\big( \RR (0,1), 1+A_2^c\big)$ is the only wall of $\fD_{(b,c)}$
whose support is not totally contained in one of the domains of linearity of
$T$; therefore, under $T$, it breaks into two parts:
\[
  \big( \RR_{\ge0} (0,1), 1+A_2^c\big)
  \quad
  \mbox{and}
  \quad
  \big( \RR_{\le 0} (b,1), 1+A_1^{bc}A_2^c\big).
\]

Next note that, since $T(-1,0)=(-1,0)$ and $T(b,-1)=(0,-1)$, $T$ maps all the
walls of $\fD_{(b,c)}\setminus\fD_{\mathrm{in},(b,c)}$ to the third quadrant. 
Indeed 
\[
  \big(\RR_{\leq0}(-b,1),1+A_1^{-bc}A_2^c\big)
\]
is the wall with the biggest slope in
$\fD_{(b,c)}\setminus\fD_{\mathrm{in},(b,c)}$ and its image is 
\[
  \big( \RR_{\le0} (0,1), 1+A_2^c\big).
\]

\begin{defn}
  $\fD_{\gr,(b,c)}$ is the scattering diagram obtained from
  $T\left(\fD_{(b,c)}\right)$ by replacing 
  \begin{itemize}
    \item
      $\big(\RR (-1,0), 1+A_1^{-b}\big)$ with $\big(\RR  (1,0), 1+A_1^b\big)$,
    \item 
      both $ \big( \RR_{\ge0} (0,1), 1+A_2^c\big)$ and $\big( \RR_{\le0} (0,1),
      1+A_2^c\big)$ with $ \big( \RR (0,1), 1+A_2^c\big)$.
  \end{itemize}
  Its base region is the cone $\sigma_\gr$ generated by $(1,0)$ and $(0,1)$.
\end{defn}

\begin{remark}
  It is not too hard to see that the scattering diagram $\fD_{\gr,(b,c)}$ is
  consistent. This fact, together with the uniqueness property implied by
  \cite[Theorem 1.7]{GHKK}, gives an alternative way to introduce it. Indeed, in
  analogy with the definition of $\fD_{(b,c)}$, one could consider the
  scattering diagram
  $\fD_{\gr,\mathrm{in},(b,c)}$ given by 
  \[
    \fD_{\gr,\mathrm{in},(b,c)}=
    \left\{
      \big(\RR (1,0), 1+A_1^b\big), 
      \big(\RR (0,1), 1+A_2^c\big)
    \right\}
  \]
  and obtain $\fD_{\gr,(b,c)}$ using Theorem \ref{KS}. 
\end{remark}

For a broken line $\gamma$ in $\fD_{(b,c)}$, we denote its image under $T$ as
$T(\gamma)$: this is the broken line in $\fD_{\gr,(b,c)}$ whose underlying map
is $\gamma\circ T$. Given any domain of linearity $L$ of $\gamma$, by
subdividing it when necessary, we can always assume that either $\gamma(L)
\subset \mathcal{H}_{+} $ or $\gamma(L)\subset \mathcal{H}_{-}$. The monomial
attached to $L$ in $T(\gamma)$ is then obtained by applying, accordingly, either
$T_+$ or $T_-$ to the exponent of the monomial attached to $L$ in $\gamma$.

\begin{theorem}
  \label{thm:T_on_broken_lines}
  The map $T$ defines a one-to-one correspondence between broken lines in $\fD_{(b,c)}$
  for $m$ with endpoint $Q$ and broken lines in $\fD_{\gr,(b,c)}$ for $T(m)$
  with endpoint $T(Q)$. In particular for $Q \in \mathcal{H}_+$ or $\mathcal{H}_-$,
  we have
  \[ 
    \vartheta^{\gr}_{T(Q),T( m)} = 
    T_{+} \left(\vartheta_{Q, m}\right) 
    \quad
    \mbox{or} 
    \quad
    T_{-} \left(\vartheta_{Q, m}\right)
  \]
  respectively.
\end{theorem}

\begin{proof}
  This is essentially the same as the argument of \cite{GHKK}, Prop.\ 3.6.  To
  prove the statement, we only need to check the bending at the $x$-axis. Let
  $L$, $L'$ be the domains of linearity of $\gamma$ before and after bending
  along $\RR (-1,0)$. So $c(L') A^{m(L')}$ is a term in 
  \[
    \theta_{-m(L),\RR(-1,0)} \left(c(L) A^{m(L)}\right)
    = 
    c(L) A^{m(L)} \left(1+A_1^{-b}\right) ^{|m_2(L)|}.
  \]

  First, assume $\gamma$ passes from $\mathcal{H}_-$ to $\mathcal{H}_+$. In this
  case, we have $m_2(L) < 0$. Now in order for the monomial
  $c(L')A^{T_+(m(L'))} =c(L')A^{m(L')}$ attached to $L'$ in
  $T\circ\gamma$ to satisfy the bending rule, it must be a term in
  \[
    \theta_{-T_-(m(L)),\RR (1,0)} \left(c(L) A^{T_-(m(L))}\right). 
  \]
  Since the second component of $T_-(m(L))$ is $m_2(L)$ we get
  \begin{align*} 
    \theta_{-T_-(m(L)),\RR (1,0)} \left(c(L) A^{T_-(m(L))}\right) 
    & =
    c(L) A^{T_-(m(L))} \left(1+A_1^b\right) ^{-m_2(L)}
    \\
    & = 
    c(L) A^{m(L)} A_1^{b m_2(L)} 
    \left(1+A_1^b\right)^{-m_2(L)} 
    \\
    & = 
    c(L) A^{m(L)} \left(1+A_1^{-b}\right) ^{-m_1(L)}.
  \end{align*}
  This shows that $T_k(\gamma)$ satisfies the correct rule when bending along
  $(\RR (1,0), 1+A_1^b)$ if $\gamma$ passes from $\mathcal{H}_-$ to
  $\mathcal{H}_+$. By repeating similar calculations, we can see that this also
  holds when $\gamma$ passes from $\mathcal{H}_+$ to $\mathcal{H}_-$.
\end{proof}

The following demonstrates the utility of using $\fD_{\gr,(b,c)}$:

\begin{prop}
  For any  $m\in M$, if $Q$ lies in the first quadrant, then 
  \[
    \vartheta^{\gr}_{Q, m}=A^{m}\left(1+f(A_1,A_2)\right)
  \]
  where $f\in (A_1,A_2)\subseteq \Bbbk[A_1,A_2]$.
  In particular, $m$ is the negative of the ${\bf d}$-vector of
  $\vartheta^{\gr}_{Q,m}$.
\end{prop}

\begin{proof}
  For any $m\in M$ and any $Q$ in the first quadrant, there is always a broken
  line $\gamma$ for $m$ and $Q$ that does not bend at any wall. Therefore $\Mono
  (\gamma) = A^{m}$ always appears as a term in $\vartheta^{\gr}_{Q,m}$.

  However, because the functions attached to the walls of
  $\fD_{\gr,(b,c)}$ are all of the form $1+g(A_1,A_2)$ with $g(A_1,A_2) \in
  (A_1,A_2) \subseteq \Bbbk[[A_1,A_2]]$, it follows that any term coming from a
  broken line which bends must be of the form $cA^{m}A_1^{d_1}A_2^{d_2}$ with
  $d_1,d_2\ge 0$, $d_1+d_2>0$. This proves the result.
\end{proof}

\sayMG{It might be appropriate to add stuff about the quantum version here.
  Right now I don't know if we can easily prove enough facts about the quantum
  version for our main result. I suggest we wait until the rest is written up
  and then I see whether it is possible to extend the proof given what we
  currently know. (For example, in general I don't know how to get the chamber
  structure that is visible in the classical case.)}

\begin{remark}
  Combining Theorem \ref{thm:T_on_broken_lines} with the above result, when $Q$
  is in the first quadrant we obtain the parametrization of
  theta functions we were after. Indeed we get 
  \[
    \vartheta^\gr_{Q,T(m)}=\vartheta_{Q,m}
  \]
  with $m$ being its ${\bf g}$-vector and $T(m)$ the negative of its 
  ${\bf d}$-vector.
\end{remark}
\saySS{Eventually we want to make a saner version of the bibliography; this is
  kind of an hack.}
\begin{thebibliography}{99}
  
  \bibitem[CPS]{CPS} M.~Carl, M.~Pumperla, and B.~Siebert, A tropical view of Landau-Ginzburg models, available at http://www.math.uni-hamburg.de/home/siebert/preprints/LGtrop.pdf
  \bibitem[FZ]{FZ} S.~Fomin and A.~Zelevinsky, Cluster algebras I: Foundations,  \textsl{J. Amer. Math. Soc.} \textbf{15} (2002), no. 2, pp.~497--529.
  \bibitem[G10]{G10} M.~Gross,  \emph{Mirror symmetry for $\mathbb{P}^2$ and tropical geometry}, Adv.\ Math., {\bf 224} (2010), 169--245. 
  \bibitem[GHK11]{GHK11} M.~Gross, P.~Hacking and S.~Keel, \emph{Mirror symmetry for log Calabi-Yau surfaces I}, preprint, 2011.
  \bibitem[GHKK]{GHKK} M.~Gross, P.~Hacking, S.~Keel, M.~Kontsevich, \emph{Canonical bases for cluster algebras}, preprint, 2014.
  \bibitem[IOTW]{IOTW} K.~Igusa, K.~Orr, G.~Todorov, J.~Weyman \emph{Picture groups of finite type and cohomology in type $A_n$}, preprint, available at http://people.brandeis.edu/~igusa/Papers/PictureGroup.pdf 
  \bibitem[LLZ2]{LLZ2} K. Lee, L. Li and A. Zelevinsky, Positivity and tameness in rank 2 cluster algebras, \textsl{J. Alg. Comb.} 2014, doi: 10.1007/s10801-014-0509-6.
  \bibitem[LLZ]{LLZ} K.~Lee, L.~Li, and A.~Zelevinsky, Greedy elements in rank 2 cluster algebras, \textsl{Selecta Math.} \textbf{20} (2014), 57--82.
  \bibitem[LLZ]{LLZ} K.~Lee, L.~Li, A.~Zelevinsky \emph{Greedy elements in rank 2 cluster algebras}, Selecta Math. (N.S.), {\bf 20}, (2014), 57--82,
  \bibitem[R]{R} N.~Reading, \emph{Universal geometric cluster algebras}, Mathematische Zeitschrift, {\bf 277 } (2014), 499-547.
  \bibitem[RS]{RS} N.~Reading, D.~Speyer, \emph{Combinatorial frameworks for cluster algebras}, preprint, 2011.
  \bibitem[SZ]{SZ} P.~Sherman and A.~Zelevinsky, Positivity and Canonical Bases in Rank 2 Cluster Algebras of Finite and Affine Types, \textsl{Mosc. Math. J.} \textbf{4} (2004), no. 4, 947--974.

\end{thebibliography}

\end{document}
